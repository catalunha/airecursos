<HTML>                                                           
<HEAD>
<title>JavaScript - Wilcoxon Distribution Function</title>

<SCRIPT LANGUAGE="JavaScript">
<!-- 
var p = new Array(1276);
var nsav=0,n,w;
 
function normalcdf(X){   //HASTINGS.  MAX ERROR = .000001
	var T=1/(1+.2316419*Math.abs(X));
	var D=.3989423*Math.exp(-X*X/2);
	var Prob=D*T*(.3193815+T*(-.3565638+T*(1.781478+T*(-1.821256+T*1.330274))));
	if (X>0) {
		Prob=1-Prob
	}
	return Prob
}

function wilcoxoncdf(n,w) {
	var Prob,t,k,sum;	
	if (w<0) {
		Prob=0
	} else if (w>=n*(n+1)/2) {
		Prob=1
	} else {
		if (n!=nsav) {
			p[0]=.5;
			p[1]=.5;
			for(t=2;t<=n*(n+1)/2;t++)
			    p[t]=0;
			for(k=2;k<=n;k++) {
				t2=k*(k+1)/2;
				t1=(k-1)*k/2;
				for(t=t2;t>t1;t--)
				    p[t]=p[t-k]/2;
				for(t=t1;t>=k;t--)
				    p[t]=(p[t]+p[t-k])/2;
				for(t=k-1;t>=0;t--)
				    p[t]=p[t]/2;
			}
			nsav=n;
		}
		sum=0;
		for(k=0;k<=w;k++)
		    sum=sum+p[k];
		Prob=sum
	}
	return Prob
}

function compute(form) {
    n=Math.floor(eval(form.argument.value));
    w=Math.floor(eval(form.cutoff.value));
	if (n<1) {
		alert("n must be positive")
	} else if (n>50) {
		mean = n*(n+1)/4;
		variance = n*n*(n+1.885)/12;
		z=(w-mean+.5)/Math.sqrt(variance);
		Prob=normalcdf(z);
	} else {
		Prob=wilcoxoncdf(n,w);
	}
	Prob=Math.round(Prob*10000)/10000;
    form.result.value = Prob;
}
// done hiding from old browsers -->
</SCRIPT>
</HEAD>

<BODY>
<center>
<hr size=5>
<h1>Signed Rank Statistic</h1>
<i>JavaScript</i>
<hr size=5>
The Wilcoxon signed rank statistic, W<sub>n</sub>, has the distribution<br>
of X<sub>1</sub>+2X<sub>2</sub>+...+nX<sub>n</sub>, where the X's are 
independent<br>
Bernoulli random variables with probability 1/2 of success.
<hr>
<FORM>
<pre>

      Enter Wilcoxon Distribution Arguments:

      sample size n: <INPUT TYPE="text" NAME="argument" Value="10" SIZE=15>
            w-value: <INPUT TYPE="text" NAME="cutoff" Value="27" SIZE=15>
</pre>

<BR>

 P(W<sub>n</sub> <= w):
<INPUT TYPE="text" NAME="result" SIZE=21>
<INPUT TYPE="button" VALUE="Calculate" ONCLICK="compute(this.form)">
<BR>
</FORM>
<hr>
The statistic W<sub>n</sub> takes values between 0 and n(n+1)/2 inclusive.<br>
The mean of W<sub>n</sub> is n(n+1)/4, and the variance is n(n+1)(2n+1)/24.
<p>
The distribution function of W<sub>n</sub> is computed exactly for n<=50.<br>
For n>50, a normal approximation with continuity correction is used.<br>
For n>50, the maximum absolute error of the approximation is .001.
</center>
</BODY>
</HTML>

