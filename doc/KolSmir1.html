<HTML>                                                           
<HEAD>
<title>Kolmogorov-Smirnov Goodness-of-Fit Test</title>

<SCRIPT LANGUAGE="JavaScript">
<!-- hide this script tag's contents from old browsers

var H=[],f=[];
var p,n,del,r;
f[0]=1;
for (var i=1;i<=41;i++) {
	H[i]=[];
    f[i]=i*f[i-1]        //f[n]=n!
}

function setupH(p,del) {   //Durbin algorithm
    var i,j;
    if (p==1) {
    	if (del>=.5) {
    		H[1][1]=0
    	} else {
			H[1][1]=1-2*del
    	}
    } else {
		for (i=1;i<p;i++) {
    	    H[i][1]=(1-Math.pow(del,i))/f[i]
    	}
    	H[p][1]=(1-2*Math.pow(del,p))/f[p];
    	if (del>.5) {
		    H[p][1]=H[p][1]+Math.pow(2*del-1,p)/f[p]
    	}
    	for (j=2;j<=p;j++) {
		    for (i=j-1;i<p;i++) {
		    	H[i][j]=1/f[i-j+1]
    		}
	    	H[p][j]=(1-Math.pow(del,p-j+1))/f[p-j+1]
    	}
    	for (j=3;j<=p;j++) {
    		for (i=1;i<=j-2;i++) {
    			H[i][j]=0
    		}
    	}
    }
}
   
function kolsmir(z) {   //Kolmogorov distribution. Error<.0000001
	var ks,y,i;
	ks=.5;
	if (z>.27) {
		ks=0;
		y=-2*z*z;
		for(i=27;i>=1;i=i-2) {
			ks=Math.exp(i*y)*(1-ks)
		}
	}
	return 1-2*ks
}

function kolexact(n,p) {
    var v=[],w=[];
    for (var i=1;i<=p;i++) {
    	v[i]=0
    }
    v[(p+1)/2]=1;
	for (var k=1;k<=n;k++) {
		for (i=1;i<=p;i++) {
			w[i]=0;
			for (var j=1;j<=p;j++) {
				w[i]=w[i]+H[i][j]*v[j]
			}
		}
		for (i=1;i<=p;i++) {
			if (k>1) {
				v[i]=w[i]*Math.pow((1-(1/k)),k-1);
			} else {
				v[i]=w[i]
			}
		}
	}
	return v[(p+1)/2]
}	

function compute(form) {
    var z,d,appr,Prob;
    d=eval(form.argument.value);
    n=Math.floor(eval(form.sample.value));
    if (n<1) {
    	alert("n must be a positive integer");
    } else {
		if (d<=0) {
			Prob=0
    	} else if (d>=1) {
			Prob=1
    	} else if (n*d>20) {
    		z=(d*n+.17)/Math.sqrt(n);
    		Prob=kolsmir(z)
    	} else {
    		r=Math.floor(n*d);
    		if (r==n*d) {r=r-1};
    		del=r+1-n*d;
			p=2*r+1;
			setupH(p,del);
			Prob=kolexact(n,p);
    	}
		Prob=Math.round(Prob*100000)/100000;
    	form.result.value = Prob
    }
}

// done hiding from old browsers -->
</SCRIPT>
</HEAD>

<BODY>
<center>
<hr size=5>
<h1>The Kolmogorov-Smirnov Goodness-of-Fit Test</h1>
<i>JavaScript</i>
<hr size=5>
Given a sample of size n from a continuous distribution function, F,<br>
the Smirnov test tests the null hypothesis that F=F<sub>0</sub>,<br> 
where F<sub>0</sub> is a given continuous distribution function.<br>
The test statistic is 
D<sub>n</sub> = sup<sub>x</sub>|F<sub>n</sub>(x)-F<sub>0</sub>(x)|,
where F<sub>n</sub> is the sample distribution function.<br>
The distribution of D<sub>n</sub> is independent of F<sub>0</sub> 
when F<sub>0</sub> is the true distribution function.

<hr>

<FORM>
<pre>
      Enter n and the cutoff point.

    Sample size n: <INPUT TYPE="text" NAME="sample" Value="100" SIZE=15>
          d-value: <INPUT TYPE="text" NAME="argument" Value=".1" SIZE=15>
<BR>
<INPUT TYPE="button" VALUE="Calculate" ONCLICK="compute(this.form)">
<BR>
   P(D<sub>n</sub> <= d) : <INPUT TYPE="text" NAME="result" SIZE=20>
</pre>
</FORM>
<hr>
For example, P(D<sub>100</sub> <= .1) = .74731.  For nd<=20, the exact 
probabilities for D<sub>n</sub> are calculated.<br>
As n tends to infinity, the distribution of &radic;n D<sub>n</sub> 
approaches the Kolgomorov distribution.<br>
If nd>20, the approximate probabilities are given using the Kolmogorov 
distribution.<br>
The error is less than .001.
</center>
</BODY>
</HTML>

