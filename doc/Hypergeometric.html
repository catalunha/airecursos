<HTML>                                                           
<HEAD>
<title>Hypergeometric Distribution</title>

<SCRIPT LANGUAGE="JavaScript">
<!-- hide this script tag's contents from old browsers


var x,m,n,nn,h,s;     //enter with m<nn/2 and n<nn/2

function hyp(x,n,m,nn) {
    var nz,mz;
    if (m<n) {         //best to have n<m
    	nz=m;
		mz=n
    } else {
		nz=n;
		mz=m
    }
	var h=1,s=1,k=0,i=0;
	while (i<x) {
	    while ((s>1)&&(k<nz)) {
	    	h=h*(1-mz/(nn-k));
	    	s=s*(1-mz/(nn-k));
	    	k=k+1;
	    }
		h=h*(nz-i)*(mz-i)/(i+1)/(nn-nz-mz+i+1);
		s=s+h;
		i=i+1;
	}
	while (k<nz) {
		s=s*(1-mz/(nn-k));
		k=k+1;
	}
	return s;
}

function compute(form) {
    var Prob,nn,m,n,x;
    nn=Math.floor(eval(form.pop1.value));
    m=Math.floor(eval(form.pop2.value));
    n=Math.floor(eval(form.sample.value));
    x=Math.floor(eval(form.argument.value));
    if ((n<=0)||(m<=0)||(nn<=0)) {
    	alert("Parameters must be positive integers");
		Prob=0
    } else if ((m>nn)||(n>nn)) {
		alert("m and n must be less than N");
		Prob=0
    } else if ((x<0)||(x<n+m-nn)) {
    	Prob=0
    } else if ((x>=n)||(x>=m)) {
		Prob=1
    } else {
        if (2*m>nn) {
			if (2*n>nn) {
				Prob=hyp(nn-m-n+x,nn-n,nn-m,nn)
			} else {
				Prob=1-hyp(n-x-1,n,nn-m,nn)
			}
        } else if (2*n>nn) {
			Prob=1-hyp(m-x-1,m,nn-n,nn)
        } else {
    	    Prob=hyp(x,n,m,nn)
        }
    }
	Prob=Math.round(Prob*100000)/100000;
    form.result.value = Prob;
}

// done hiding from old browsers -->
</SCRIPT>
</HEAD>

<BODY>
<center>
<hr size=5>
<h1>Hypergeometric Distribution</h1>
<i>JavaScript</i>
<hr size=5>
From a population of size N, containing a subpopulation of size m, a sample 
of size n is drawn at random without replacement.  The number, X, 
of the sample that were drawn from the subpopulation 
is said to have a Hypergeometric distribution, H(N,m,n).

<hr>

<FORM>
<pre>
      Enter the population sizes, the sample size and the cutoff point.

       Population size N: <INPUT TYPE="text" NAME="pop1" Value="1600" SIZE=15>
    Subpopulation size m: <INPUT TYPE="text" NAME="pop2" Value="400" SIZE=15>
           Sample size n: <INPUT TYPE="text" NAME="sample" Value="300" SIZE=15>
                 x-value: <INPUT TYPE="text" NAME="argument" Value="75" SIZE=15>
</pre>

<BR>
P(X <= x|N,m,n) :
<INPUT TYPE="text" NAME="result" SIZE=20>
<INPUT TYPE="button" VALUE="Calculate" ONCLICK="compute(this.form)">
<BR>
</FORM>
<hr>
The exact probability is calculated.  For example, 
P( X<= 75|1600,400,300) = .53252.<br>
Computation time is proportional to x+min(m,n,N-m,N-n).


</center>
</BODY>
</HTML>

